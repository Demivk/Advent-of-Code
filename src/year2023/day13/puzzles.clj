(ns year2023.day13.puzzles
  (:require
    [utils :as utils]))

(def input (slurp (utils/input-file-path 2023 13)))

; The copied input needs a cleanup, using a string for now
(def input-as-string "#..##..\n#.##.##\n#####..\n#..#.#.\n.####..\n#.#.#..\n#.#.#..\n\n##.##.###\n##.##.###\n..####..#\n###.#.###\n###.#..#.\n#.###....\n###.#...#\n###.#...#\n#.###....\n###.#..#.\n###.#.###\n..##.#..#\n##.##.###\n\n..####.\n#......\n.##..##\n#.#..#.\n#......\n#.#..#.\n#.#..#.\n#......\n###..##\n.##..##\n#......\n\n#..####..#..#..\n.###..###.##.##\n.#......#.####.\n###....########\n##......######.\n..##..##..##..#\n.#..##..#.##.#.\n.###..###.##.##\n#..####..####..\n..#....#..##..#\n.########....##\n#..####..####..\n#.######.#..#.#\n###.##.########\n.#.#..#.#.##.#.\n....##.........\n#.##..##.#..#.#\n\n#..###..#..\n#..###..#..\n###.#####..\n#####.##..#\n#.#.#....##\n.##..##....\n#.#...##.#.\n####...####\n####...####\n#.#...##.##\n.##..##....\n#.#.#....##\n#####.##..#\n\n...#...#.#.##\n##....#.##.#.\n##..#.#.#....\n...##.#####..\n###..#...#...\n###.#....###.\n##..####....#\n...#.####...#\n##...##.###.#\n##...##.###.#\n..##.####...#\n##..####....#\n###.#....###.\n###..#...#...\n...##.#####..\n##..#.#.#....\n##....#.##.#.\n\n###.##..#\n#####....\n#####....\n##....##.\n####.#..#\n...#.....\n.#.######\n\n##..####.###.\n###.##..##...\n...####.#..##\n...####.#..##\n######..##...\n##..####.###.\n#.##...##..#.\n.#..##..##..#\n.#..##..##..#\n#.##...##..#.\n##..####.###.\n######..##...\n...####.#..##\n...####.#..##\n###.##..##...\n##..####.###.\n.##.#.....#.#\n\n...#.#..##..#.#\n.###..#.##.#..#\n..##..######..#\n..#.##......##.\n#.###.##..##.##\n.....#......#..\n.....#......#..\n#.###.##..##.##\n..#.##......##.\n..##..######..#\n.###..#.##.#..#\n...#.#..##..#.#\n.##.##......##.\n..#...#....#...\n.#...#########.\n\n###.######.\n#.#..#...#.\n.###...#.##\n###.#.##...\n##.##...#.#\n##.##...#.#\n###.#.##...\n.###..##.##\n#.#..#...#.\n###.######.\n###.######.\n#.#..#...#.\n.###..##.##\n\n######.\n..###..\n.#.##.#\n#....#.\n#....#.\n.#.##.#\n..###..\n######.\n#####..\n\n##....#.#\n##..#.#.#\n.#...###.\n#..#.....\n.##.....#\n#.#.#..#.\n.##..###.\n##...####\n##.#####.\n##.###...\n.####....\n.####....\n##.###...\n\n#...##.#...#.#.\n#.#######...###\n###..##....##.#\n....#.#.###...#\n....#.#.###...#\n###...#....##.#\n#.#######...###\n#...##.#...#.#.\n.###...##.##...\n.###...##.##...\n#...##.#...#.#.\n\n###..#.\n###..#.\n.####..\n.##....\n###..#.\n.####.#\n.##..#.\n.##.###\n#####..\n#..#...\n.#..##.\n.#..##.\n#..##..\n\n.#####.#...#..#..\n.#####.#...#..#..\n#.#.##...#...##.#\n##...##.##..###.#\n....#..####....##\n....#..#.##....##\n##...##.##..###.#\n\n#####.#.#\n#...##..#\n#######.#\n######.##\n.##.#..##\n#####..#.\n#..###.##\n#..#.##..\n.##....##\n#####.###\n#####.###\n.##....##\n#..#.##..\n#..###.##\n#####..#.\n\n..#....#####.\n..#.##.####.#\n##.##.######.\n....####..###\n########..###\n....#.##..##.\n##.#.########\n......#.##.#.\n..#..##....##\n\n##..#..#.#.#.\n##..#..#.#.#.\n##.#.##.....#\n.#.#.##..###.\n..#...####..#\n#.....#..####\n#..#..#..####\n..#...####..#\n.#.#.##..###.\n\n.#..##..#..##..#.\n#........######..\n##########.##.###\n.#..##..#.####.#.\n....##....#..#...\n###....###.....##\n.###..###......##\n#..#..#..######..\n##......########.\n###.##.###.##.###\n##..##..##....##.\n#.######.#.##.#.#\n.#......#.####.#.\n####..#####..####\n##.####.###..###.\n\n.##...##...\n#...#....#.\n#..########\n.##.#....#.\n#..##....##\n#..##....##\n......##...\n\n....#####.##.\n#####.#.##.##\n....#.##.#..#\n.....#...#..#\n####..####..#\n#########..##\n#######.....#\n#######.#.###\n....#.#....#.\n....##....###\n.##...####..#\n\n#....#.###..###.#\n##..##.##.##.##.#\n.####.#........#.\n..##..##.####.##.\n#.##.####....####\n....#..#.#..#.#..\n#....###.#..#.###\n.......#.####.#..\n#.##.#...#..#...#\n#.##.#.##....##.#\n.#..#..#.####.#..\n#.##.#.#.####.#.#\n.####.###.##.###.\n\n.....#..#.....###\n...#.#..#.#....##\n#####.##.######..\n.#..######..#....\n.##.##..##.##.#..\n.###.####.###..##\n#.#........#.###.\n.#..#.##.#..#.#..\n....#.##.#.....##\n####......#######\n#.#.#....#.#.#...\n.###.#..#.###....\n####..##..####.##\n\n##..####...#.\n##..##.#.#..#\n######.###...\n.......#....#\n#....###....#\n.......#..#..\n..##....#.#.#\n\n.#.........\n..#.#######\n##.##...##.\n###.####...\n###.####...\n##.##...##.\n..#.#######\n.#.........\n.###.###..#\n####.#.##.#\n#.####.#..#\n#.####.##.#\n####.#.##.#\n.###.###..#\n.#.........\n\n####....##....#\n...#....##....#\n.##...#....#...\n#..#.##.##.##.#\n.###.##.##.##.#\n.###.##.##.##.#\n##.############\n\n....######.....\n#....#..#....##\n..##..##..##...\n..##########...\n..##.####.##...\n..####..####...\n.##.....#..##..\n####..##..#####\n#.##########.##\n#.##..##..##.##\n.###.#..#.###..\n#.#.#....#.#.##\n#...##..##...##\n\n.......#.\n#..#.#..#\n.#####.##\n####..#.#\n#####.#..\n.##.##.#.\n.##.##.#.\n#####.#..\n####..#.#\n\n.#..#..#..###..#.\n#.##.#.####..##..\n######.##.###.#..\n######.##.###.#..\n#.##.#.####..##..\n.#..#..#..###..#.\n#....#..#..##.#..\n#....####..#####.\n..##..#...##..#..\n###############..\n...#..####.#.##.#\n\n.##..######\n....#######\n.##.#...#.#\n#####.###.#\n######.##.#\n....###....\n.....#...#.\n#..###..###\n.....##...#\n.##..##...#\n#..#...##.#\n.##....#.##\n.##...##.##\n#..#...##.#\n.##..##...#\n\n#....#..####..#..\n#.....###..###...\n.#.#..##....##..#\n##..#...####...#.\n.##.##.....#..##.\n..#.#..#....#..#.\n#.#######..######\n.#...#..####..#..\n.#..##.#....#.##.\n.#.####......####\n.#.####......####\n\n......##.##.##.\n..####.#....###\n....##........#\n#####..#....#..\n........####...\n..###..######..\n...##..######..\n...#..###..###.\n#####..#.##.#..\n###..#..####..#\n..#.###.#..#.##\n\n#.....##.....\n.###..##..###\n.##..#..#..##\n###.#....#.##\n###...##...##\n.###..##..###\n....##..##...\n#............\n##.##....##.#\n.##..#..#..##\n.####....####\n\n#...#.#.##...\n...###.##..##\n..###.#.##...\n.###.###...#.\n##.#...#.###.\n#...###.#.#.#\n..#####...#.#\n..#####...#.#\n#...###.#.#.#\n##.#...#.###.\n.###.###...#.\n..###.#.##...\n...#.#.##..##\n#...#.#.##...\n.#.#....####.\n.#.#....####.\n#...#.#.##...\n\n..#..#.#..##..#\n#..#.#....##...\n.#.#####......#\n#..###.###..###\n##.#...###..###\n..##.##....#...\n#..###.##....##\n...####.######.\n...####.######.\n\n.#.##.#.##.#.\n.#.####....##\n.##...######.\n.##...######.\n.#.####....##\n.#.##.#.##.#.\n.#######..###\n#..####....##\n..###.#...##.\n..###..#..#..\n#..#.########\n\n....#..#.\n####.#.#.\n...###.##\n..#..##.#\n##...#...\n##.##.#..\n##.....#.\n##...##.#\n...####.#\n.#...####\n####...#.\n###..###.\n..#####.#\n..#..##.#\n..#..##.#\n\n##.#.#..##..##.#.\n.###.##.#....###.\n#..#.#.#.##.#.###\n#....#.########.#\n.....#..#.###.##.\n#....###....#####\n.###....###...###\n.###....###...###\n#....###....####.\n..####.###..##..#\n..####.###..##..#\n#....###....####.\n.###....###...###\n.###....###...###\n#....###....#####\n\n.###.##.###..\n.##.####.##..\n..########...\n.#..####..#..\n..#.#..#.#...\n.#.#....#.#..\n..##.##.##...\n#.##....##.##\n.##.####.##..\n#.##....##.##\n..#..##..#...\n#.#.#..#.#.##\n.#........#..\n#....#.....##\n.###....###..\n\n..##.#..#.#\n..##.##...#\n..##..#...#\n..##.#..#.#\n##.#..####.\n...#..#.#.#\n...###.#.##\n###.##..###\n##..##.##..\n...##..#..#\n..###.##.#.\n##...###..#\n..#..####.#\n\n##.##.#.##....#\n.........##.#..\n....#...###.#.#\n####..#.####.##\n.#..##...##.##.\n#.#.##.#####.#.\n.#.#.#...#..###\n#..#.####..##.#\n#..#.#.###.##.#\n##..#.##..#####\n#...#.##..#####\n.#..#####..##.#\n..#...#.######.\n..#...#.######.\n.#..#####..##.#\n#...#.##..#####\n##..#.##..#####\n\n.#..###.##.\n..#.####..#\n####...#..#\n...#.##....\n###.####..#\n#####...##.\n###.#..####\n##.#.#.####\n....#.#.##.\n..##.###..#\n..####.....\n\n#.##.#.###.##..\n####.##.#..#..#\n#..#.#.####...#\n#..##.##.####..\n#..######...##.\n.....##.####..#\n####.##..######\n#######..#..#.#\n#..##.#.#.##...\n.##...#.#.#....\n....#..#...##.#\n#..#...##.#.#..\n.##...#..##.#.#\n####....#.#.#..\n#####.###.####.\n......##.#....#\n......##.#....#\n\n#.###.##.###.#.\n#.###.##.###.#.\n...#.#..#.#...#\n##.##.##.##.##.\n.##.#.##.#.##..\n#.#........#.#.\n.#.#.####.#.#..\n....#....#.....\n.############..\n#.##..##..##.##\n.#####..#####.#\n#....#..#......\n.#..#....#..#.#\n#..#.#..#.#..##\n##....##....###\n\n...###.\n....##.\n...#..#\n...##.#\n..#####\n#.#.##.\n.#..##.\n.#..##.\n#.#.##.\n..#####\n...##.#\n...#..#\n....##.\n\n#.#......\n..#.#..#.\n..###..##\n##...##..\n###.##.#.\n.#.##..##\n###......\n##.......\n##...##..\n##...##..\n##.......\n\n...#.#.\n###..##\n#...#..\n..#.#..\n..#.#..\n#...#..\n###..##\n...#.#.\n.######\n.######\n...###.\n\n#...#.#####....##\n#.####..##......#\n######.####....##\n###.##.#.#.####.#\n.#.#.##...#....#.\n.##......#.####.#\n..######...####..\n#..#..##....##...\n###.#..#.........\n#....##...##..##.\n.#.####.##.#..#.#\n#..#...#..##..##.\n#.#..###...####..\n#...#...##.#..#.#\n#...##.#...####..\n#...##.#...####..\n#...#....#.#..#.#\n\n##.....##..###.\n#......##..###.\n#..##..##.###..\n......#...#####\n.#####....##.##\n..#...#.##....#\n.##.#.###.#...#\n.##.#.###.#...#\n..#...#.##....#\n.#####....##.##\n......#...#####\n\n#.##....##.##\n.###....###..\n#.#..##..#.##\n.###....###..\n...######....\n.##########..\n...#....#....\n.##.#..#.##..\n#.##....##.##\n#..........##\n#...#..#...##\n##...##...#..\n.#..####..#..\n\n####.###.#...\n####.###.#...\n.##.#....#.##\n######..#.###\n######.#.#.#.\n#..#..##..#..\n.##....##.###\n.....##.#.##.\n#..####..#.##\n#....##.####.\n.##..##.#..#.\n.##..#..##...\n####.##..##.#\n....#.##.#..#\n....######..#\n......##..#.#\n####..#.##..#\n\n#.##.##.##.##.##.\n.###....###......\n##..#..#..##.#..#\n.#.#....#.#.##..#\n##.##..##.##..##.\n##.#....#.##..##.\n.#.##..##.#.#.##.\n#.########.#.....\n##.#.##.#.####..#\n..##.##.##..##..#\n.##########......\n.#.##..##.#..####\n...######.....##.\n###.####.###.....\n.#.######.#..####\n.###.##.##...####\n.#.#....#.#..####\n\n####.###.\n....##...\n......###\n....###..\n#..##..#.\n######...\n######...\n#..##..#.\n....###..\n......###\n....##...\n####..##.\n.##.#.##.\n####...##\n#..##.##.\n......###\n#####....\n\n##..####..##.\n##.######.##.\n.....##.....#\n##.#.##.#.###\n##.##..##.##.\n.#.#....#.#..\n##...##...##.\n#####..######\n##..####..###\n##...##...##.\n..########..#\n##.#.##.#.###\n##...##...###\n####.##.#####\n##.#.##.#.##.\n##.######.##.\n..#.####.#..#\n\n#.##.##......##.#\n#.##.##......##.#\n.#.##..##......#.\n#.##..##..##...#.\n##....#...#....##\n.#.###..###......\n##.##..#....##.##\n##.##..#....##.##\n.#.###..###......\n##....#...#....##\n#.##..#...##...#.\n.#.##..##......#.\n#.##.##......##.#\n\n.#..#..\n.##.##.\n.###..#\n##.####\n##.####\n.###..#\n.##.##.\n.#..##.\n#..###.\n..#.###\n#.#....\n###...#\n###...#\n#.#....\n..#.###\n\n...##...####.\n####.........\n..#..###.##.#\n###..#.######\n##..#########\n###..........\n..#..##......\n##...#..#..#.\n....##.###.##\n..#..########\n....#.#......\n##.#.########\n..###........\n###.#########\n...#...######\n..#.#.#######\n#####..#....#\n\n....#...#\n#.#.#.#..\n#.#.#.#..\n.#..#...#\n##.#.####\n..##.#.#.\n.....#...\n#####...#\n####...#.\n##....#.#\n..#...###\n..#...###\n##....#.#\n\n....#...#\n####.##.#\n.##.##...\n####....#\n.##..####\n.##...###\n####....#\n\n##.#..#\n####..#\n###.#..\n##..##.\n##..##.\n..#.#..\n####..#\n\n.....#..#\n###......\n#.#######\n#.#######\n..##.....\n##.######\n..#######\n.########\n...##....\n\n##.#..#.#\n.#.#.##..\n##.##..##\n....###.#\n....###.#\n##.##..##\n.#.#.##..\n##.#..###\n..###....\n.##..####\n.##..####\n..###....\n##.#..###\n\n......##.#.\n#####.#.##.\n.##.#.#####\n.....##.#.#\n....##.#.##\n#..#.##.#.#\n#..#.##.#.#\n....#..#.##\n.....##.#.#\n.##.#.#####\n#####.#.##.\n......##.#.\n.......##.#\n#..###..#..\n.##..##.###\n\n.#.#.#..#\n#..#..##.\n##..##..#\n##.##.##.\n#.#.##.##\n....#####\n#...#....\n.#.#.....\n.####....\n..#......\n..#......\n.####....\n.#.#.....\n\n......###..\n..###.#.#..\n#......#.##\n.####..#.##\n##.###.#...\n##.####....\n.#....#..##\n##.##..#...\n#.#.###....\n..#..######\n..#..######\n#.#.###....\n#####..#...\n.#....#..##\n##.####....\n##.###.#...\n.####..#.##\n\n.####..##\n##..##..#\n#....###.\n#....###.\n##..###.#\n.####..##\n.#..#.#.#\n######.##\n.####..#.\n\n###.#..#.\n###.#..#.\n.#..#.#.#\n###..##..\n..#.###.#\n...#.####\n.###..###\n#...#.###\n#...#.###\n.#.#..###\n...#.####\n..#.###.#\n###..##..\n.#..#.#.#\n###.#..#.\n\n#..#...#..#.#.#\n#..###......###\n.....########..\n#..###.####.###\n........##.....\n#..###......###\n....#...##...#.\n####.##.##.##.#\n#..##.#.##.#.##\n####....##....#\n####.#..##..#.#\n......##..##...\n.##.##.####.##.\n\n#...##...#...\n######...##.#\n#.####...##.#\n.#.######.#..\n.##...##.#.#.\n.##...##.#.#.\n.#.######.#..\n#.####...##.#\n######...##.#\n\n...###..#.#...#\n##.#..###.#..#.\n...######.##.##\n...######.##.##\n##.#..###.#..#.\n...###..#.#...#\n..#..#.##.##.#.\n..#.#.##.#...##\n...##....#....#\n##.###..#...#.#\n.#..###..###.##\n..##.###..#..#.\n..#..#####.##.#\n##.##.#.####.#.\n####...####.##.\n##..#.#..#.#...\n..#.#.#.#.#.##.\n\n..##.#.#.##\n.###.#.#.##\n.#..#......\n####.##.#.#\n#.#..##..##\n.##..#.#.#.\n###........\n##....#.##.\n.###.####.#\n......#.##.\n##.#..##.#.\n#...##.#...\n..#..####.#\n..#..####.#\n#...##.#...\n\n#.########.#..#..\n#.########.#..#..\n##.#.##.#.###.#.#\n#..##..##..#.###.\n....#..##........\n#....##....##.#..\n###......###..#.#\n#.###..###.##....\n..##.##.##..#.#..\n#..######..#..##.\n..###..###.......\n##..#..#..##.###.\n##.######.###.###\n#....##....#...#.\n...##..##...#.###\n\n#####.####.\n##..#..#.#.\n##..###....\n###.###.#.#\n....####.#.\n..####.#.#.\n######..#..\n######..#..\n..####.#.#.\n....####.#.\n###.###.#.#\n##..###....\n##..#..#.#.\n#####.####.\n###.#.####.\n...###.#.#.\n.###.###...\n\n..##.#.####.#.##.\n..##.#.####.#.##.\n.##.#.##..##.#.##\n.#.#..######.##.#\n#...###....###...\n##.############.#\n..##############.\n...#####..#####..\n#.#....####....#.\n##..##......##..#\n.#.##..####..##.#\n#.##.#.#..#.#.##.\n..#..#.#..#.#..#.\n.##.##..##..##.##\n#.##.#.#..#.#.##.\n\n####.##.#\n.....####\n........#\n#..#.##..\n....#.##.\n.##.##.##\n.##.##..#\n\n##.##..##.#####\n##..#..#..###..\n.#.#.##.#.#.###\n.#.#.##.#.#..##\n.#..#..#..#.#.#\n##..#..#..##...\n.#...##...#.###\n..#.####.#..#..\n##.#.##.#.##.##\n.###....###....\n##........###..\n\n.#.####.#.##.#.\n##......######.\n##########..###\n#...##..##..##.\n.#.#..#.#.##.#.\n..######..##..#\n##.#..#.##..##.\n\n.#.#####.#.####\n#...##..#######\n..#...##.......\n##......#..####\n.####.##.######\n.###..#########\n##.##.#.##.....\n###.#.##.##.##.\n..#.###...#....\n..#.#...#.#....\n.#.#.....######\n#####.###.#####\n..#..##.##.####\n.#..#....#.####\n.#....#.#.#....\n\n#.#.####.#.\n.#.##..##.#\n#...#..#...\n####....###\n...#.##.#..\n...##..##..\n...##..##..\n...#.##.#..\n####....###\n#...#..#...\n.#.##..##.#\n#.#.####.#.\n.....##....\n..##....##.\n###.#######\n.#.#.##.#.#\n####.##.###\n\n##..##..##..###\n##.###..###.##.\n###.#.##.#.####\n###.#.##.#.####\n##.###..###.##.\n##..##..##..###\n#..###..###..##\n..#.##..##.#...\n#.#..##.#..#.##\n\n....##...#.###.#.\n####.#...##.###..\n.##.####.##.##.##\n####.#.##...#.#.#\n....###.#.####..#\n#..###.##.#.#.#..\n#..###.#..##..#.#\n.##...###...###.#\n.##.##.###...#.#.\n.##.##.###...#.#.\n.##...###...###.#\n#..###.#...#..#.#\n#..###.##.#.#.#..\n\n#######.##.#....#\n#.##..#..##......\n..#..####...##...\n######..#...#...#\n...#....#.#.##...\n.#..##....#.##..#\n#..#.##.###.###.#\n...#.###......#..\n#.##.#.##..#..###\n####..######.##.#\n####..######.#..#\n#.#.##.#.##.#....\n#.#.##.#.##.#....\n####..######.#..#\n####..######.##.#\n\n.#.####.#.#.##.\n.#.####.#..###.\n.#..##..#.#.###\n##......##.##.#\n##.####.####.##\n..##..##..#.###\n..##..##..#####\n\n#.#####..#.#.#...\n..##..##.#.####..\n..#.##.#.#.#..#..\n.#.##.#.#...#.###\n.##..##.....#####\n.###...#.#..#....\n#..#..##....#.###\n.#.###.....##....\n..#.#####.##..#..\n.....###...###.##\n.....###...###.##\n..#.#####.##..#..\n.#.###.....##....\n#..#.###....#.###\n.###...#.#..#....\n\n##.####..##\n.#...#.##.#\n.#..#.#..#.\n.###.......\n####.#.##.#\n##.#.#.##.#\n.###.......\n.#..#.#..#.\n.#...#.##.#\n##.####..##\n####.######\n#..####..##\n###..######\n#####.####.\n.#...######\n####...##..\n#.#########\n\n#.##..##.#..#\n#.######.#.##\n..#....#..###\n#........####\n.#.####.#....\n##..##..#####\n##..##..###..\n..........###\n####..####...\n##..##..###..\n####..#######\n\n#.##..####.##.#\n.###.####.#.##.\n..#.#.##.#...##\n....#.##....###\n#.#.##.#####.##\n..#....#.....##\n..#....#.....##\n#.#.##.#####.##\n....#.##....###\n..#.#.##.#...##\n.###.####.#.##.\n#.##..####.##.#\n##...##.#.###..\n##...##.#.###..\n#.##..####..#.#\n.###.####.#.##.\n..#.#.##.#...##\n\n#######.#..\n#.##.#....#\n......##...\n##..######.\n..##...#.#.\n.####..##..\n#....#.##..\n.#..#.#..##\n.......#.#.\n......##.#.\n.#..#.#..##\n\n#..#..#.####.\n.##.###......\n..#..##.#..##\n#..#######..#\n#####....####\n#..##.#.##..#\n####.###..##.\n######.#..#.#\n....###.##.##\n......#......\n#..#..#.##...\n####.##...##.\n####.##...##.\n\n###..####\n.#...#.##\n#..###.##\n#.#.##...\n..#.#####\n####..#..\n.##.##.##\n#.##.....\n#.###....\n\n.####.#\n.####.#\n.#.#.#.\n.....#.\n##..#..\n...###.\n...###.\n##..#..\n.#...#.\n.#.#.#.\n.####.#\n\n..#..##.#........\n##.##.#...###..##\n##.##.#...###..##\n..#..#..#........\n#..##.###..######\n###.##.##.#######\n..#...#.##...##..\n.#....#.#........\n##.#.####..#....#\n#.#.##....#######\n.#####...#.......\n##.####.#.###..##\n#.######.###.##.#\n#.#.#.####.#....#\n...#######.######\n\n.##..##\n#..##..\n#..#.##\n....#..\n....#..\n#..#.##\n#..##..\n.##..##\n######.\n####..#\n...#.#.\n\n.##.#.####.\n.##.#.####.\n.####..#.##\n.#####.#.#.\n#.#..#.###.\n##.#######.\n..####....#\n#.##..###.#\n#.##..###.#\n..##.#....#\n##.#######.\n#.#..#.###.\n.#####.#.#.\n.####..#.##\n.##.#.####.\n\n..#......#....#\n.####..####..##\n#.#.####.#.##..\n.#.######.#..#.\n#.########.##.#\n#....##....##..\n...##..##......\n\n#.##...##\n..#.#.###\n##...####\n.###.....\n.###.....\n##...####\n..###.###\n#.##...##\n####.####\n.####.#.#\n#..#.#.##\n######.#.\n..######.\n##.##.###\n##.##.###\n\n#....#..#....#.##\n.###......###.#..\n.#..######..#..##\n.#.#.####.#.#....\n.#.##....##.#..##\n...##.##.##....##\n...###..###....##\n###..####..###...\n..#.#.##.#.......\n...########......\n######..#########\n..##..##..##.....\n.....####.....###\n#.##.#..#.##.##..\n.#...#..#...#..##\n\n...##.#\n...###.\n###.###\n###.###\n...###.\n...##.#\n###..#.\n.####..\n.#.....\n#.#....\n#.#....\n.#.....\n.####..\n###..#.\n..###.#\n\n#.#....#...\n#.#.#..#...\n#.#.#..#...\n#.#....#...\n###.....#.#\n..#.#....##\n#..#.##...#\n\n#.##.##########\n.####.###....##\n.........####..\n#....#.#.....##\n.#..#.###.##.##\n#....#.#.#..#.#\n.#..#.#########\n......##.####.#\n..##...###..###")

(defn map-pattern [pattern] (mapv utils/split-every-character (utils/read-rows pattern)))

(defn difference-count [a b] (count (filterv false? (mapv = a b))))

(defn check-mirrors [pattern d]
  (reduce
    (fn [_ line-nr]
      ; rseq is apparently better than reverse!
      (let [before (take-last line-nr (rseq pattern))
            after (drop line-nr pattern)]
        (if (= (reduce + (mapv difference-count before after)) d)
          (reduced line-nr)
          0)))
    0
    (range 1 (count pattern))))

(defn check-horizontal [patterns d] (* 100 (apply + (mapv #(check-mirrors % d) patterns))))

(defn check-vertical [patterns d] (apply + (mapv #(check-mirrors (utils/transpose-grid %) d) patterns)))

(defn part-1 []
  (let [patterns (mapv map-pattern (utils/split-double-new-lines input-as-string))]
    (+ (check-horizontal patterns 0) (check-vertical patterns 0))))

(defn part-2 []
  (let [patterns (mapv map-pattern (utils/split-double-new-lines input-as-string))]
    (+ (check-horizontal patterns 1) (check-vertical patterns 1))))
